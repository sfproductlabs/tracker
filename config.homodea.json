{
    "Domains": [
        "staging.homodea.com"
    ],
    "SchemaVersion": 1,
    "ApiVersion": 1,
    "StaticDirectory": "public",
    "ProxyUrl": "http://localhost:3030",
    "UseLocalTLS": true,
    "TLSCert" : "pem/tracker.cert.pem",
    "TLSKey" : "pem/tracker.key.pem",
    "ProxyPortTLS" : ":8443",
    "ProxyPort" : ":8080",
    "ProxyDailyLimit" : 0,
    "ProxyDailyLimitChecker" : "cassandra",
    "MaximumConnections": 2048,
    "Debug" : true,
    "UrlPrefixFilter" : "http(s|)://(localhost|staging\\.homodea\\.com)(:[0-9]*|)(/.*)",
    "Notify": [
        {
            "Service": "cassandra",
            "Hosts": [
                "cassandra-seed1"
            ],
            "Context": "sfpla",
            "Timeout" : 30,
            "CACert": "pem/cassandra.cacert.pem",
            "Cert": "pem/cassandra.cert.pem",
            "Key": "pem/cassandra.key.pem",
            "Secure": false,
            "Retry": false,
            "Critical" :true,
            "Filter": [
                {
                    "Alias": "log",
                    "Id": "log",
                    "Queries": [
                        {
                            "Statement": "INSERT INTO logs JSON ?",
                            "QueryType": "json",
                            "Fields": [
                                {
                                    "Type": "string",
                                    "Id": "name"
                                },
                                {
                                    "Type": "string",
                                    "Id": "hostname"
                                },
                                {
                                    "Type": "int",
                                    "Id": "level"
                                },
                                {
                                    "Type": "string",
                                    "Id": "msg"
                                },
                                {
                                    "Type": "string",
                                    "Id": "ip"
                                },
                                {
                                    "Type": "string",
                                    "Id": "username"
                                },
                                {
                                    "Type": "date",
                                    "Id": "ldate"
                                },
                                {
                                    "Type": "time",
                                    "Id": "ltime"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Alias": "count",
                    "Id": "count",
                    "Queries": [
                        {
                            "Statement": "UPDATE counters set total=total+1 where id=? AND type=?",
                            "Fields": [
                                {
                                    "Type": "string",
                                    "Id": "id"
                                },
                                {
                                    "Type": "string",
                                    "Id": "type"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Alias": "update",
                    "Id": "update",
                    "Queries": [
                        {
                            "Statement" : "INSERT INTO updates (id, updated, msg) values (?,?,?)",
                            "Fields": [
                                {
                                    "Type": "string",
                                    "Id": "id",
                                    "Default": "id"                                    
                                },
                                {
                                    "Type": "datetime",
                                    "Id": "updated"
                                },
                                {
                                    "Type": "string",
                                    "Id": "msg"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "Service": "nats",
            "Hosts": [
                "tls://nats-seed1:4222"
            ],
            "Context": "toc.track.notify",
            "Secure": true,
            "CACert": "pem/nats.cacert.pem",
            "Cert": "pem/nats.cert.pem",
            "Key": "pem/nats.key.pem",
            "Format": "json"
        }
    ],
    "Consume": [
        {
            "Service": "http",
            "Note": "Not implemented"
        },
        {
            "Service": "nats",
            "Hosts": [
                "tls://nats-seed1:4222"
            ],
            "Secure": true,
            "Critical" : true,
            "CACert": "pem/nats.cacert.pem",
            "Cert": "pem/nats.cert.pem",
            "Key": "pem/nats.key.pem",
            "Format": "json",
            "MessageLimit": 65536,
            "BytesLimit": 67108864,
            "Filter": [
                {
                    "Alias": "log",
                    "Type": "chan",
                    "Id": "tic.log.>"
                },
                {
                    "Alias": "count",
                    "Type": "chan",
                    "Id": "tic.count.>"
                },
                {
                    "Alias": "update",
                    "Type": "chan",
                    "Id": "tic.update.>"
                }
            ]
        }
    ]
}